<!DOCTYPE html>
<html lang="de-CH">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tagebuch — AI Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Mein Tagebuch</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="check.html">Check</a>
      <a href="todos.html">Todos</a>
    </nav>
  </header>

  <main>
    <section class="card">
      <h2>Neuer Eintrag</h2>
      <form id="diary-form">
        <label>
          Datum:
          <input type="date" id="diary-date">
        </label>
        <textarea id="diary-text" placeholder="Schreibe deine Gedanken und Gefühle auf..." rows="5"></textarea>
        <button type="submit">Speichern</button>
      </form>
    </section>

    <section class="card">
      <h2>Deine Einträge</h2>
      <ul id="diary-list"></ul>
    </section>
  </main>

  <footer>
    <p>Dein persönliches Tagebuch — vertraulich gespeichert im Browser.</p>
  </footer>

  <script>
    const db = {
      get(key) { try { return JSON.parse(localStorage.getItem(key)) || []; } catch(e) { return []; } },
      set(key, data) { localStorage.setItem(key, JSON.stringify(data)); }
    };

    const diaryForm = document.getElementById('diary-form');
    const diaryDate = document.getElementById('diary-date');
    const diaryText = document.getElementById('diary-text');
    const diaryList = document.getElementById('diary-list');

    // Set today as default
    diaryDate.valueAsDate = new Date();

    function renderDiary() {
      const entries = db.get('diaryEntries');
      diaryList.innerHTML = '';

      if (!entries.length) {
        diaryList.innerHTML = '<li class="empty-state">Noch keine Einträge. Starten Sie jetzt!</li>';
        return;
      }

      entries.slice().reverse().forEach(e => {
        const li = document.createElement('li');
        li.classList.add('diary-entry');
        li.innerHTML = `
          <div>
            <strong>${e.date}</strong>
            <p>${e.text}</p>
          </div>
          <button class="del-btn" data-date="${e.date}">✕</button>
        `;
        diaryList.appendChild(li);
      });
    }

    diaryForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const date = diaryDate.value;
      const text = diaryText.value.trim();
      if (!text) return;
      const entries = db.get('diaryEntries');
      entries.push({ date, text });
      db.set('diaryEntries', entries);
      diaryText.value = '';
      diaryDate.valueAsDate = new Date();
      renderDiary();
    });

    diaryList.addEventListener('click', (e) => {
      if (e.target.classList.contains('del-btn')) {
        const date = e.target.dataset.date;
        let entries = db.get('diaryEntries');
        entries = entries.filter(e => e.date !== date);
        db.set('diaryEntries', entries);
        renderDiary();
      }
    });

    renderDiary();
  </script>
</body>
</html>
